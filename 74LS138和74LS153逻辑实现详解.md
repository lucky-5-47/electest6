# 74LS138å’Œ74LS153é€»è¾‘å®ç°è¯¦è§£

## 1ï¸âƒ£ 74LS138 (3çº¿-8çº¿è¯‘ç å™¨) é€»è¾‘å®ç°

### ğŸ“ æ–‡ä»¶ä½ç½®
**æ–‡ä»¶**ï¼š`74ls138.js` ç¬¬130-187è¡Œ

### ğŸ” é€»è¾‘å‡½æ•°å®Œæ•´ä»£ç 

```javascript
const ls138LogicFunction = {
    '74ls138': (inputs) => {
        // ç¬¬1æ­¥ï¼šè·å–è¾“å…¥å€¼
        const A2 = inputs.A2 || 0;  // åœ°å€è¾“å…¥2
        const A1 = inputs.A1 || 0;  // åœ°å€è¾“å…¥1
        const A0 = inputs.A0 || 0;  // åœ°å€è¾“å…¥0
        const G1 = inputs.G1 || 0;  // ä½¿èƒ½è¾“å…¥1ï¼ˆé«˜ç”µå¹³æœ‰æ•ˆï¼‰
        const G2A = inputs.G2A || 0;  // ä½¿èƒ½è¾“å…¥2Aï¼ˆä½ç”µå¹³æœ‰æ•ˆï¼‰
        const G2B = inputs.G2B || 0;  // ä½¿èƒ½è¾“å…¥2Bï¼ˆä½ç”µå¹³æœ‰æ•ˆï¼‰

        // ç¬¬2æ­¥ï¼šè½¬æ¢ä¸ºæ•°å­—ç±»å‹
        const a2 = Number(A2) || 0;
        const a1 = Number(A1) || 0;
        const a0 = Number(A0) || 0;
        const g1 = Number(G1) || 0;
        const g2a = Number(G2A) || 0;
        const g2b = Number(G2B) || 0;

        // ç¬¬3æ­¥ï¼šæ£€æŸ¥ä½¿èƒ½æ¡ä»¶
        // ä½¿èƒ½æ¡ä»¶ï¼šG1=1 ä¸” G2A=0 ä¸” G2B=0
        const enableCondition = (g1 === 1) && (g2a === 0) && (g2b === 0);

        // ç¬¬4æ­¥ï¼šåˆå§‹åŒ–æ‰€æœ‰è¾“å‡ºä¸º1ï¼ˆç¦ç”¨æ—¶æ‰€æœ‰è¾“å‡ºéƒ½æ˜¯1ï¼‰
        let outputs = {
            Y0: 1, Y1: 1, Y2: 1, Y3: 1,
            Y4: 1, Y5: 1, Y6: 1, Y7: 1
        };

        // ç¬¬5æ­¥ï¼šå¦‚æœä½¿èƒ½ï¼Œæ ¹æ®åœ°å€é€‰æ‹©è¾“å‡º
        if (enableCondition) {
            // è®¡ç®—åœ°å€ï¼šA2A1A0 çš„äºŒè¿›åˆ¶å€¼
            // ä¾‹å¦‚ï¼šA2=1, A1=0, A0=1 â†’ (1<<2)|(0<<1)|1 = 5
            const selectedOutput = (a2 << 2) | (a1 << 1) | a0;

            // å°†é€‰ä¸­çš„è¾“å‡ºè®¾ä¸º0ï¼Œå…¶ä»–ä¿æŒ1
            switch(selectedOutput) {
                case 0: outputs.Y0 = 0; break;  // 000 -> Y0=0
                case 1: outputs.Y1 = 0; break;  // 001 -> Y1=0
                case 2: outputs.Y2 = 0; break;  // 010 -> Y2=0
                case 3: outputs.Y3 = 0; break;  // 011 -> Y3=0
                case 4: outputs.Y4 = 0; break;  // 100 -> Y4=0
                case 5: outputs.Y5 = 0; break;  // 101 -> Y5=0
                case 6: outputs.Y6 = 0; break;  // 110 -> Y6=0
                case 7: outputs.Y7 = 0; break;  // 111 -> Y7=0
            }
        }

        return outputs;
    }
};
```

### ğŸ“Š 74LS138çœŸå€¼è¡¨

| G1 | G2A | G2B | A2 | A1 | A0 | Y0 | Y1 | Y2 | Y3 | Y4 | Y5 | Y6 | Y7 |
|----|-----|-----|----|----|----|----|----|----|----|----|----|----|
| 0  | X   | X   | X  | X  | X  | 1  | 1  | 1  | 1  | 1  | 1  | 1  | 1  |
| 1  | 1   | X   | X  | X  | X  | 1  | 1  | 1  | 1  | 1  | 1  | 1  | 1  |
| 1  | X   | 1   | X  | X  | X  | 1  | 1  | 1  | 1  | 1  | 1  | 1  | 1  |
| 1  | 0   | 0   | 0  | 0  | 0  | 0  | 1  | 1  | 1  | 1  | 1  | 1  | 1  |
| 1  | 0   | 0   | 0  | 0  | 1  | 1  | 0  | 1  | 1  | 1  | 1  | 1  | 1  |
| 1  | 0   | 0   | 0  | 1  | 0  | 1  | 1  | 0  | 1  | 1  | 1  | 1  | 1  |
| 1  | 0   | 0   | 0  | 1  | 1  | 1  | 1  | 1  | 0  | 1  | 1  | 1  | 1  |
| 1  | 0   | 0   | 1  | 0  | 0  | 1  | 1  | 1  | 1  | 0  | 1  | 1  | 1  |
| 1  | 0   | 0   | 1  | 0  | 1  | 1  | 1  | 1  | 1  | 1  | 0  | 1  | 1  |
| 1  | 0   | 0   | 1  | 1  | 0  | 1  | 1  | 1  | 1  | 1  | 1  | 0  | 1  |
| 1  | 0   | 0   | 1  | 1  | 1  | 1  | 1  | 1  | 1  | 1  | 1  | 1  | 0  |

### ğŸ”„ é€»è¾‘æµç¨‹

```
è¾“å…¥ä¿¡å· (A2, A1, A0, G1, G2A, G2B)
    â†“
æ£€æŸ¥ä½¿èƒ½æ¡ä»¶ï¼šG1=1 && G2A=0 && G2B=0
    â†“ æ˜¯
è®¡ç®—åœ°å€ï¼š(A2<<2) | (A1<<1) | A0
    â†“
æ ¹æ®åœ°å€é€‰æ‹©è¾“å‡ºï¼ˆ0-7ï¼‰
    â†“
é€‰ä¸­çš„è¾“å‡º=0ï¼Œå…¶ä»–è¾“å‡º=1
    â†“
è¾“å‡º8ä¸ªä¿¡å· (Y0-Y7)
```

---

## 2ï¸âƒ£ 74LS153 (4é€‰1æ•°æ®é€‰æ‹©å™¨) é€»è¾‘å®ç°

### ğŸ“ æ–‡ä»¶ä½ç½®
**æ–‡ä»¶**ï¼š`74ls153_final.js` ç¬¬78-103è¡Œ

### ğŸ” é€»è¾‘å‡½æ•°å®Œæ•´ä»£ç 

```javascript
function ls153LogicFunction(inputs) {
    // ç¬¬1æ­¥ï¼šè·å–è¾“å…¥å€¼ï¼Œè®¾ç½®é»˜è®¤å€¼
    const { D0 = 0, D1 = 0, D2 = 0, D3 = 0, A0 = 0, A1 = 0, S = 1 } = inputs;

    // ç¬¬2æ­¥ï¼šæ£€æŸ¥ä½¿èƒ½æ¡ä»¶
    // å½“SÌ„=1æ—¶ï¼ˆç¦æ­¢çŠ¶æ€ï¼‰ï¼Œè¾“å‡ºä¸º0
    if (S === 1) {
        return { Y: 0 };
    }

    // ç¬¬3æ­¥ï¼šå½“SÌ„=0æ—¶ï¼ˆä½¿èƒ½çŠ¶æ€ï¼‰ï¼Œæ ¹æ®åœ°å€é€‰æ‹©æ•°æ®
    // è®¡ç®—åœ°å€ï¼šA1A0 çš„äºŒè¿›åˆ¶å€¼
    // ä¾‹å¦‚ï¼šA1=1, A0=0 â†’ (1<<1)|0 = 2
    const address = (A1 << 1) | A0;
    let Y = 0;

    // ç¬¬4æ­¥ï¼šæ ¹æ®åœ°å€é€‰æ‹©å¯¹åº”çš„æ•°æ®è¾“å…¥
    switch (address) {
        case 0: Y = D0; break;  // åœ°å€00 -> é€‰æ‹©D0
        case 1: Y = D1; break;  // åœ°å€01 -> é€‰æ‹©D1
        case 2: Y = D2; break;  // åœ°å€10 -> é€‰æ‹©D2
        case 3: Y = D3; break;  // åœ°å€11 -> é€‰æ‹©D3
    }

    // ç¬¬5æ­¥ï¼šè¿”å›è¾“å‡º
    return { Y };
}
```

### ğŸ“Š 74LS153çœŸå€¼è¡¨

| SÌ„ | A1 | A0 | Y  |
|---|----|----|-----|
| 1 | X  | X  | 0   |
| 0 | 0  | 0  | D0  |
| 0 | 0  | 1  | D1  |
| 0 | 1  | 0  | D2  |
| 0 | 1  | 1  | D3  |

### ğŸ”„ é€»è¾‘æµç¨‹

```
è¾“å…¥ä¿¡å· (D0, D1, D2, D3, A0, A1, SÌ„)
    â†“
æ£€æŸ¥ä½¿èƒ½æ¡ä»¶ï¼šSÌ„=0
    â†“ æ˜¯
è®¡ç®—åœ°å€ï¼š(A1<<1) | A0
    â†“
æ ¹æ®åœ°å€é€‰æ‹©æ•°æ®è¾“å…¥
    â†“
è¾“å‡ºé€‰ä¸­çš„æ•°æ® (Y)
```

---

## 3ï¸âƒ£ é€»è¾‘å‡½æ•°å¦‚ä½•è¢«è°ƒç”¨

### ğŸ“ æ–‡ä»¶ä½ç½®
**æ–‡ä»¶**ï¼š`merged_complete.html`

### ğŸ” è°ƒç”¨æµç¨‹

#### ç¬¬1æ­¥ï¼šæ³¨å†Œé€»è¾‘å‡½æ•°ï¼ˆç¬¬1628-1643è¡Œï¼‰
```javascript
// é›†æˆ74LS138ç»„ä»¶çš„é€»è¾‘å‡½æ•°
if (window.LS138Component && window.LS138Component.logic) {
    logicFunctions['74ls138'] = window.LS138Component.logic;
}

// é›†æˆ74LS153ç»„ä»¶çš„é€»è¾‘å‡½æ•°
if (window.LS153Component && window.LS153Component.logic) {
    logicFunctions['74ls153'] = window.LS153Component.logic;
}
```

#### ç¬¬2æ­¥ï¼šä¿¡å·ä¼ æ’­æ—¶è°ƒç”¨ï¼ˆç¬¬3614-3734è¡Œï¼‰
```javascript
// å½“ä¿¡å·ä¼ æ’­åˆ°74LS138æ—¶
else if (targetType === '74ls138') {
    // è·å–è¾“å…¥çŠ¶æ€
    const inputs = get74LS138InputStates(targetComponent);
    
    // è°ƒç”¨é€»è¾‘å‡½æ•°è®¡ç®—è¾“å‡º
    const outputState = logicFunctions['74ls138'](inputs);
    
    // ä¿å­˜è¾“å‡ºçŠ¶æ€
    componentStates.set(targetId, outputState);
    
    // ç»§ç»­ä¼ æ’­ä¿¡å·
    propagateSignal(targetComponent);
}

// å½“ä¿¡å·ä¼ æ’­åˆ°74LS153æ—¶
else if (targetType === '74ls153') {
    // è·å–è¾“å…¥çŠ¶æ€
    const inputs = get74LS153InputStates(targetComponent);
    
    // è°ƒç”¨é€»è¾‘å‡½æ•°è®¡ç®—è¾“å‡º
    const outputState = logicFunctions['74ls153'](inputs);
    
    // ä¿å­˜è¾“å‡ºçŠ¶æ€
    componentStates.set(targetId, outputState);
    
    // æ›´æ–°æ˜¾ç¤º
    if (window.updateLS153Display) {
        window.updateLS153Display(targetComponent);
    }
    
    // ç»§ç»­ä¼ æ’­ä¿¡å·
    propagateSignal(targetComponent);
}
```

#### ç¬¬3æ­¥ï¼šè·å–è¾“å…¥çŠ¶æ€ï¼ˆç¬¬4128-4160è¡Œå’Œç¬¬4701-4760è¡Œï¼‰
```javascript
// è·å–74LS138çš„è¾“å…¥çŠ¶æ€
function get74LS138InputStates(component) {
    const inputAnchors = Array.from(component.querySelectorAll('.input-anchor'));
    const inputs = {};

    inputAnchors.forEach(inputAnchor => {
        const pinName = inputAnchor.getAttribute('data-pin');
        // æŸ¥æ‰¾è¿æ¥åˆ°è¿™ä¸ªé”šç‚¹çš„ä¿¡å·æº
        // è·å–ä¿¡å·æºçš„è¾“å‡ºå€¼
        // å­˜å‚¨åˆ°inputså¯¹è±¡
    });

    return inputs;
}

// è·å–74LS153çš„è¾“å…¥çŠ¶æ€
function get74LS153InputStates(component) {
    const inputAnchors = Array.from(component.querySelectorAll('.input-anchor'));
    const inputs = {};

    inputAnchors.forEach(inputAnchor => {
        const pinName = inputAnchor.getAttribute('data-pin');
        // æŸ¥æ‰¾è¿æ¥åˆ°è¿™ä¸ªé”šç‚¹çš„ä¿¡å·æº
        // è·å–ä¿¡å·æºçš„è¾“å‡ºå€¼
        // å­˜å‚¨åˆ°inputså¯¹è±¡
    });

    return inputs;
}
```

---

## 4ï¸âƒ£ å®Œæ•´çš„é€»è¾‘æ‰§è¡Œæµç¨‹

```
ç”¨æˆ·åœ¨ç”»å¸ƒä¸Šè¿æ¥ç»„ä»¶
    â†“
ç”¨æˆ·æ”¹å˜è¾“å…¥ä¿¡å·ï¼ˆå¦‚æŒ‰ä¸‹æŒ‰é’®ï¼‰
    â†“
è§¦å‘ propagateSignal() å‡½æ•°
    â†“
éå†æ‰€æœ‰è¿æ¥çš„è¾“å‡ºé”šç‚¹
    â†“
å¯¹äºæ¯ä¸ªè¿æ¥çš„ç›®æ ‡ç»„ä»¶
    â†“
è·å–ç›®æ ‡ç»„ä»¶çš„è¾“å…¥çŠ¶æ€ (get74LS138InputStates / get74LS153InputStates)
    â†“
è°ƒç”¨é€»è¾‘å‡½æ•°è®¡ç®—è¾“å‡º (logicFunctions['74ls138'] / logicFunctions['74ls153'])
    â†“
ä¿å­˜è¾“å‡ºçŠ¶æ€åˆ° componentStates
    â†“
æ›´æ–°ç»„ä»¶æ˜¾ç¤º
    â†“
ç»§ç»­ä¼ æ’­ä¿¡å·åˆ°ä¸‹ä¸€ä¸ªç»„ä»¶
```

---

## 5ï¸âƒ£ å…³é”®æ¦‚å¿µ

### ä½ç§»æ“ä½œç¬¦ (Bitwise Shift)
```javascript
// å·¦ç§»ï¼š<< 
// ä¾‹å¦‚ï¼š1 << 2 = 4 (äºŒè¿›åˆ¶ï¼š001 << 2 = 100)
const address = (A2 << 2) | (A1 << 1) | A0;
// A2=1, A1=0, A0=1
// (1<<2) = 4 (100)
// (0<<1) = 0 (000)
// 1 = 1 (001)
// 4 | 0 | 1 = 5 (101)
```

### æŒ‰ä½æˆ–æ“ä½œç¬¦ (Bitwise OR)
```javascript
// | æ“ä½œç¬¦ï¼šå°†å¤šä¸ªä½ç»„åˆæˆä¸€ä¸ªæ•°å­—
// ä¾‹å¦‚ï¼š4 | 0 | 1 = 5
// äºŒè¿›åˆ¶ï¼š100 | 000 | 001 = 101
```

### é€»è¾‘ä¸æ“ä½œç¬¦ (Logical AND)
```javascript
// && æ“ä½œç¬¦ï¼šæ‰€æœ‰æ¡ä»¶éƒ½ä¸ºçœŸæ‰è¿”å›çœŸ
const enableCondition = (g1 === 1) && (g2a === 0) && (g2b === 0);
// åªæœ‰å½“ g1=1 ä¸” g2a=0 ä¸” g2b=0 æ—¶ï¼ŒenableCondition æ‰ä¸º true
```

