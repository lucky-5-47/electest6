# 信号传播实现详解

## 1、信号传播入口函数propagateSignal()
- **技术要点**：
  - 使用`querySelectorAll('.output-anchor')` 找到所有输出锚点
  - 通过`getComponentOutputState()` 获取每个输出锚点的具体状态值
  - 通过 `anchorConnections.get(anchor)` 获取所有连接到该锚点的目标锚点
  - 对每个目标锚点调用`propagateToTarget()`信号传播到目标锚点的函数 
- **功能分支连线信号传播**：
  - wires.filter() 找到所有从当前组件分支出去的连线
  - 通过 wire.branchFrom 找到分支的源连线，获取原始连线的信号状态
  - 再递归的将信号传播到分支连线的终点
  
## 2、信号传播到目标锚点的函数 propagateToTarget()
- **对不同的组件类型分类处理信号**
- **获取组合逻辑的输入状态**
  - 直接锚点连接：通过 anchorConnections Map查找
  - 普通连线连接：通过 wires 数组中的 wire.end 匹配
  - 分支连线连接：通过 wire.branchFrom 追溯到原始信号源
- **多个信号源的处理**：
  - 使用 Array.some() 方法实现OR逻辑，无连接默认为0
- **状态计算和存储**：
  - 使用逻辑门计算函数logicFunctions计算逻辑门输出
  - 更新 componentStates Map 存储组件状态
  - 递归调用propagateSignal()继续传播信号

## 3、获取组件输出状态的函数 getComponentOutputState()
- **普通逻辑门**：
  - 直接获取状态并返回
- **多输出组件**：
  - 通过 getAttribute('cy') 获取锚点的Y坐标
  - 根据锚点位置确定返回哪个输出值

## 4、时钟信号的处理
- **时钟信号的产生**：


